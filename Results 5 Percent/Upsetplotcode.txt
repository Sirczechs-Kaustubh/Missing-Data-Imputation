# Load necessary libraries
library(UpSetR)
library(dplyr)

# List of significant genes from each imputation method
significant_genes_list <- list(
    ClustImpute_5 = significant_genes_clustimpute,
    missForest_5 = significant_genes_missforest,
    amelia_imp_5 = significant_genes_amelia,
    XGB_imp_5 = significant_genes_xgb,
    SVD_imputation_5 = significant_genes_svd,
    RegLLs_imputation_5 = significant_genes_reglls,
    PCA_imputation_5 = significant_genes_pca,
    KNN_imputation_5 = significant_genes_knn,
    mice_imp_5 = significant_genes_mice
)

# Prepare the data for UpSet plot
upset_data <- fromList(significant_genes_list)

# Generate the UpSet plot
upset(upset_data, sets = names(significant_genes_list), keep.order = TRUE, 
      order.by = "freq", main.bar.color = "blue", sets.bar.color = "red",
      text.scale = c(2, 1.5, 1.5, 1.5, 1.5, 1.5), number.angles = 30, 
      point.size = 3.5, line.size = 2.5)
